{# templates/security/login.html.twig (example path) #}
{% extends 'frontend/base-login.html.twig' %}

{% block title %}Авторизация - Небесный Архив{% endblock %}
{% block body_id 'login' %}

{% block main %}
  <div class="na-auth-page">
    <div class="na-auth-overlay"></div>

    <div class="na-auth-content">
      <div class="na-auth-panel">
        {# mini logo #}
        <div class="na-auth-logo">
          <img src="{{ asset('images/logo.png') }}" alt="Небесный Архив" class="na-auth-logo__img" loading="eager" fetchpriority="high" decoding="sync">
        </div>

        {# big AUTH heading #}
        <div class="na-auth-heading">АВТОРИЗАЦИЯ</div>

        {# form #}
        <form action="{{ path('security_login') }}" method="post" class="na-auth-form">
          {% if error %}
            <div class="na-auth-error">
              {{ error.messageKey|trans(error.messageData, 'security') }}
            </div>
          {% endif %}

          <div class="na-auth-field">
            <div class="na-auth-field-label">ЛОГИН</div>
            <input
              type="text"
              id="username"
              name="_username"
              value="{{ last_username }}"
              placeholder="Email"
              autocomplete="username"
              required
            >
          </div>

          <div class="na-auth-field">
            <div class="na-auth-field-label">ПАРОЛЬ</div>
            <input
              type="password"
              id="password"
              name="_password"
              placeholder="Пароль"
              autocomplete="current-password"
              required
            >
          </div>

          <input type="hidden" name="_target_path" value="{{ app.request.get('redirect_to') }}"/>
          <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}"/>

          <button type="submit" class="na-auth-submit">
            ВОЙТИ
          </button>
        </form>
      </div>
    </div>
  </div>
{% endblock %}

{% block sidebar %}{# no sidebar on new layout #}{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  {# Aggressive preload for instant image display #}
  <link rel="preload" as="image" href="{{ asset('images/logo.png') }}" fetchpriority="high">
  <link rel="preload" as="image" href="{{ asset('images/credential-bg.png') }}" fetchpriority="high">
  <style>
    /* kill default auth layout only on this page */
    #login .auth-wrapper{
      background:none !important;
      align-items:stretch;
      min-height:100vh;
    }
    #login .auth-box{
      width:100%;
      max-width:none;
      margin:0;
      padding:0;
      background:transparent;
      box-shadow:none;
      border-radius:0;
    }
    #login #loginform{
      width:100%;
      height:100%;
    }

    :root{
      --na-auth-blue:#21324b;
      --na-auth-blue-dark:#111822;
      --na-auth-outline:rgba(255,255,255,.75);
      --na-auth-soft:rgba(255,255,255,.85);
    }

    .na-auth-page{
      position:relative;
      min-height:100vh;
      display:flex;
      justify-content:flex-end;
      align-items:stretch;
      background:url('{{ asset('images/credential-bg.png') }}') center center / cover no-repeat;
      overflow:hidden;
      color:#fff;
    }

    .na-auth-overlay{
      position:absolute;
      inset:0;
      background:
        radial-gradient(circle at 80% 40%, rgba(255,255,255,.1), transparent 60%),
        linear-gradient(to bottom right, rgba(0,0,0,.55), rgba(0,0,0,.3));
      mix-blend-mode:multiply;
      pointer-events:none;
    }

    .na-auth-content{
      position:relative;
      z-index:5;
      width:100%;
      max-width:1320px;
      margin:0 auto;
      padding:60px 40px;
      box-sizing:border-box;
      display:flex;
      justify-content:flex-end;
      align-items:center;
    }

    .na-auth-panel{
      width:100%;
      max-width:480px;
      margin-right:40px;
    }

    .na-auth-logo{
      display:inline-flex;
      align-items:center;
      margin-bottom:26px;
    }
    .na-auth-logo__img{
      height:auto;
      max-height:60px;
      width:auto;
      max-width:180px;
      display:block;
    }

    .na-auth-heading{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:.9rem 2.4rem;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.9);
      background:radial-gradient(circle at 50% 0, #4f7ff6, #1f3a87);
      box-shadow:0 0 24px rgba(63,119,255,.75);
      font-family:"Times New Roman", Georgia, serif;
      font-weight:800;
      letter-spacing:.12em;
      text-transform:uppercase;
      margin-bottom:40px;
      font-size:1.1rem;
    }

    .na-auth-form{
      display:flex;
      flex-direction:column;
      gap:18px;
    }

    .na-auth-field{
      display:flex;
      align-items:center;
      border-radius:14px;
      border:1px solid var(--na-auth-outline);
      background:rgba(0,0,0,.35);
      box-shadow:0 16px 32px rgba(0,0,0,.65);
      overflow:hidden;
      min-height:64px;
    }
    .na-auth-field-label{
      padding:0 24px;
      font-size:.8rem;
      text-transform:uppercase;
      letter-spacing:.16em;
      white-space:nowrap;
      border-right:1px solid rgba(255,255,255,.4);
      color:var(--na-auth-soft);
    }
    .na-auth-field input{
      flex:1;
      border:none;
      background:transparent;
      color:#fff;
      padding:14px 22px;
      font-size:.95rem;
      outline:none;
    }
    .na-auth-field input::placeholder{
      color:rgba(255,255,255,.55);
    }

    .na-auth-submit{
      margin-top:26px;
      align-self:flex-start;
      min-width:220px;
      padding:14px 36px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.9);
      background:radial-gradient(circle at 50% 0, #4f7ff6, #1f3a87);
      box-shadow:0 18px 40px rgba(0,0,0,.75), 0 0 32px rgba(63,119,255,.7);
      color:#fff;
      font-weight:600;
      letter-spacing:.1em;
      text-transform:uppercase;
      font-size:.9rem;
      cursor:pointer;
    }

    .na-auth-submit:hover{
      filter:brightness(1.05);
    }

    .na-auth-error{
      background:rgba(220,53,69,.95);
      border-radius:8px;
      padding:.6rem .9rem;
      font-size:.85rem;
      margin-bottom:4px;
    }

    @media (max-width:991.98px){
      .na-auth-content{
        padding:40px 20px;
        justify-content:center;
      }
      .na-auth-panel{
        margin-right:0;
      }
    }
  </style>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script>
    {% if error %}
      toastr.error('', '{{ error.messageKey|trans(error.messageData, 'security') }}');
    {% endif %}
  </script>
{% endblock %}
